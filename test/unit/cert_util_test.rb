require 'test_helper'
require 'util/cert_util'

class CertUtilTest < Test::Unit::TestCase

	include Util::CertUtil

	def test_tail_cert

		cert=%{-----BEGIN CERTIFICATE-----
MIIEEDCCA3mgAwIBAgIBAjANBgkqhkiG9w0BAQUFADCBnzELMAkGA1UEBhMCVVMx
CzAJBgNVBAgTAlZBMRMwEQYDVQQHEwpCbGFja3NidXJnMRIwEAYDVQQKEwlSYWNr
c3BhY2UxFzAVBgNVBAsTDkluZnJhc3RydWN0dXJlMQ4wDAYDVQQDEwVsb2dpbjEO
MAwGA1UEKRMFbG9naW4xITAfBgkqhkiG9w0BCQEWEmNvYnJhQHNuYWtlb2lsLmNv
bTAeFw0xMDEyMjIwMzE4MDdaFw0yMDEyMTkwMzE4MDdaMIGhMQswCQYDVQQGEwJV
UzELMAkGA1UECBMCVkExEzARBgNVBAcTCkJsYWNrc2J1cmcxEjAQBgNVBAoTCVJh
Y2tzcGFjZTEXMBUGA1UECxMOSW5mcmFzdHJ1Y3R1cmUxEDAOBgNVBAMTB2NsaWVu
dDExDjAMBgNVBCkTBWxvZ2luMSEwHwYJKoZIhvcNAQkBFhJjb2JyYUBzbmFrZW9p
bC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAPLC14pngFD+dbjsgViL
3pD+l2sV02DdI52/D14Y6OAzOV/uAjYnhGaNvs1FFjnhza/8lkytsMY1tteJhIy6
0dnw4fEoZ8ndKvxI0B/2xOztlIkl5/HHJknvI1kEnDp785rLC8/TxWATy8EF/rIY
5rzN1O24yAKM1h4b8aoh1mZPAgMBAAGjggFWMIIBUjAJBgNVHRMEAjAAMC0GCWCG
SAGG+EIBDQQgFh5FYXN5LVJTQSBHZW5lcmF0ZWQgQ2VydGlmaWNhdGUwHQYDVR0O
BBYEFFiTK4T0Nhaj/GRihkodha2QmP+xMIHUBgNVHSMEgcwwgcmAFEHd2iWSHPSh
qS7L+CCjrwMJEky2oYGlpIGiMIGfMQswCQYDVQQGEwJVUzELMAkGA1UECBMCVkEx
EzARBgNVBAcTCkJsYWNrc2J1cmcxEjAQBgNVBAoTCVJhY2tzcGFjZTEXMBUGA1UE
CxMOSW5mcmFzdHJ1Y3R1cmUxDjAMBgNVBAMTBWxvZ2luMQ4wDAYDVQQpEwVsb2dp
bjEhMB8GCSqGSIb3DQEJARYSY29icmFAc25ha2VvaWwuY29tggkAzuccVphXN4sw
EwYDVR0lBAwwCgYIKwYBBQUHAwIwCwYDVR0PBAQDAgeAMA0GCSqGSIb3DQEBBQUA
A4GBAIOiIVV7aHdi+Z0MaMcv0xZ9SbBACS9OWZbZ/nz2SI/riF1Uy08KzdjVmMbz
bNiOOPnp2R+THLlgIv96kkH/DDrqVFRXd0vzfDp5R88f1l+volIQ4XuIUEzwl3t7
2S+xLqhcVmNUUQl4E6DFIpVG9tglKSaa65oP6e5PsWWbY05S
-----END CERTIFICATE-----}
		assert_equal cert, tail_cert(%{blah\nblah\n#{cert}})

	end

end
